(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,n,t){},16:function(e,n,t){e.exports=t.p+"static/media/logo.5d5d9eef.svg"},17:function(e,n,t){},18:function(e,n,t){"use strict";t.r(n);var o=t(0),r=t.n(o),a=t(8),i=t.n(a),s=(t(15),t(16),t(17),t(2)),c=t(3),l=t(5),u=t(4),d=t(1),h=t(6),p=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(l.a)(this,Object(u.a)(n).call(this,e))).renderer=null,t.updateGraph=t.updateGraph.bind(Object(d.a)(t)),t}return Object(h.a)(n,e),Object(c.a)(n,[{key:"updateGraph",value:function(e){this.renderer&&this.renderer.engine(this.props.params.renderer).renderDot(e)}},{key:"componentDidMount",value:function(){this.renderer=window.d3.select(".graph").graphviz({height:"700px",fit:!0}),console.log(this.renderer)}},{key:"render",value:function(){return console.log("render graphviz"),this.updateGraph(this.props.dot),r.a.createElement("div",{className:"Z2mnetwork"},r.a.createElement("div",{className:"graph"},"hallo z2mnetwork"))}}]),n}(r.a.Component),g=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(l.a)(this,Object(u.a)(n).call(this,e))).onConnect=t.onConnect.bind(Object(d.a)(t)),t.onMessage=t.onMessage.bind(Object(d.a)(t)),t.client=null,t.prevGraph=null,t}return Object(h.a)(n,e),Object(c.a)(n,[{key:"componentDidMount",value:function(){this.client=window.mqtt.connect("ws://"+this.props.config.server),this.client.subscribe("zigbee2mqtt/bridge/networkmap/graphviz"),this.client.on("message",this.onMessage),this.client.on("connect",this.onConnect)}},{key:"onConnect",value:function(){console.log("Connected"),this.client.publish("zigbee2mqtt/bridge/networkmap","graphviz"),this.props.config.onConnect()}},{key:"onMessage",value:function(e,n){console.log("z2mcl received");var t=new TextDecoder("utf-8").decode(n);this.props.config.onMessage(e,t),setTimeout(function(){this.client.publish("zigbee2mqtt/bridge/networkmap","graphviz")}.bind(this),1e4)}},{key:"render",value:function(){return console.log("render z2mclient"),null}}]),n}(r.a.Component),v=function(e){function n(e){var t;return Object(s.a)(this,n),(t=Object(l.a)(this,Object(u.a)(n).call(this,e))).prevgraph=null,t.onConnect=t.onConnect.bind(Object(d.a)(t)),t.onMessage=t.onMessage.bind(Object(d.a)(t)),t.state={status:"idle",dot:null,dotparams:{renderer:t.props.config.renderer}},t.clientConfig={onConnect:t.onConnect,onMessage:t.onMessage,server:t.props.config.mqttserver},t}return Object(h.a)(n,e),Object(c.a)(n,[{key:"onConnect",value:function(){console.log("Connected"),this.setState({status:"connected"})}},{key:"onMessage",value:function(e,n){console.log("z2mn received"),n!==this.prevgraph&&(console.log("changed"),this.prevgraph=n,this.setState({dot:n}))}},{key:"render",value:function(){return console.log("render z2mnetwork"),r.a.createElement("div",null,"Renderer: ",this.state.dotparams.renderer," Server: ",this.clientConfig.server," Status: ",this.state.status,r.a.createElement(g,{config:this.clientConfig}),r.a.createElement(p,{dot:this.state.dot,params:this.state.dotparams}))}}]),n}(r.a.Component);var m=function(){var e=window.location.search.substr(1);return null!==e&&""!==e?function(e){for(var n={},t=e.split("&"),o=0;o<t.length;o++){var r=t[o].split("=");n[r[0]]=r[1]}return n}(e):{}}(),f={renderer:"dot",mqttserver:"192.168.178.18:9001"};!function(e,n){Object.keys(n).forEach(function(t){e[t]=n[t]})}(f,m);var b=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(v,{config:f}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(b,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},9:function(e,n,t){e.exports=t(18)}},[[9,1,2]]]);
//# sourceMappingURL=main.ca107af5.chunk.js.map